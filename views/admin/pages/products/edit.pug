extends ../../layouts/default.pug
include ../../mixins/page-header.pug
include ../../mixins/category-options.pug

block main
  +pageHeader("Chỉnh sửa sản phẩm", product.title)

  .admin-form-card
    form(
      action=`${prefixAdmin}/products/edit/${product._id}?_method=PATCH`
      method="POST"
      enctype="multipart/form-data"
    )
      .form-row
        .form-col
          .form-group
            label.form-label Tên sản phẩm
              span.required *
            input.form-input(
              type="text"
              name="title"
              placeholder="Nhập tên sản phẩm"
              value=product.title
              required
            )

          .form-group
            label.form-label Danh mục sản phẩm
            select.form-input.form-select(name="product_category_id")
              option(value="" selected=(product.product_category_id === "" || !product.product_category_id)) ── Chọn danh mục ──
              if categories
                +categoryOptions(categories, 1, product.product_category_id || "")

          .form-group
            label.form-label Mô tả
            textarea.form-input.form-textarea(
              name="description"
              placeholder="Nhập mô tả sản phẩm"
              rows="5"
            )= product.description

          .form-row-inline
            .form-group.form-group-half
              label.form-label Giá (VNĐ)
                span.required *
              input.form-input(
                type="text"
                name="price"
                placeholder="Nhập giá"
                value=product.price
                required
              )
            .form-group.form-group-half
              label.form-label Giảm giá (%)
              input.form-input(
                type="text"
                name="discountPercentage"
                placeholder="Nhập % giảm giá"
                value=product.discountPercentage
              )

          .form-row-inline
            .form-group.form-group-half
              label.form-label Số lượng
              input.form-input(
                type="text"
                name="stock"
                placeholder="Nhập số lượng"
                value=product.stock
              )
            .form-group.form-group-half
              label.form-label Vị trí
              input.form-input(
                type="text"
                name="position"
                placeholder="Tự động"
                value=product.position
              )

          .form-group
            label.form-label Trạng thái
            select.form-input.form-select(name="status")
              option(
                value="active"
                selected=(product.status === "active")
              ) Hoạt động
              option(
                value="inactive"
                selected=(product.status === "inactive")
              ) Dừng hoạt động

        .form-col.form-col-side
          .form-group
            label.form-label Ảnh
            .upload-area#uploadArea
              input.upload-input(
                type="file"
                name="thumbnail"
                id="uploadFile"
                accept="image/*"
              )
              if product.thumbnail
                .upload-placeholder#uploadPlaceholder(style="display:none")
                  i.fas.fa-cloud-upload-alt
                  p Kéo thả hoặc click để chọn ảnh
                  span.upload-hint Hỗ trợ: JPG, PNG, GIF, WebP (tối đa 5MB)
                img.upload-preview#uploadPreview(
                  src=product.thumbnail
                  alt="Preview"
                  style="display:block"
                )
              else
                .upload-placeholder#uploadPlaceholder
                  i.fas.fa-cloud-upload-alt
                  p Kéo thả hoặc click để chọn ảnh
                  span.upload-hint Hỗ trợ: JPG, PNG, GIF, WebP (tối đa 5MB)
                img.upload-preview#uploadPreview(src="" alt="Preview")

      .form-actions
        a.btn-cancel(href=`${prefixAdmin}/products`) Huỷ
        button.btn-submit(type="submit")
          i.fas.fa-save
          |  Lưu thay đổi

block append scripts
  script(src="/admin/js/upload-preview.js")
  script(src="/admin/libs/tinymce/tinymce.min.js")
  script(src="/admin/js/tinymce-init.js")

