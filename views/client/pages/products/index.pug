extends ../../layouts/default

block main
  .container.py-4
    //- Page header
    .d-flex.justify-content-between.align-items-center.mb-4
      .page-header-left
        h2.page-title
          i.fas.fa-box.mr-2
          | Danh sách sản phẩm
        p.text-muted.mb-0
          | Tổng cộng: 
          strong= products.length
          |  sản phẩm

    //- Product grid
    if products && products.length > 0
      .row
        each product in products
          .col-lg-3.col-md-4.col-sm-6.mb-4
            .card.product-card.h-100.shadow-sm
              //- Product thumbnail
              if product.thumbnail
                .product-img-wrapper
                  img.card-img-top.product-img(src=product.thumbnail alt=product.title)
                  //- Status badge

                  //- Discount badge
                  if product.discountPercentage && product.discountPercentage > 0
                    span.badge.badge-danger.product-discount-badge
                      | -#{product.discountPercentage}%
              else
                .product-img-wrapper
                  .product-img-placeholder
                    i.fas.fa-image.fa-3x.text-muted

                  if product.discountPercentage && product.discountPercentage > 0
                    span.badge.badge-danger.product-discount-badge
                      | -#{product.discountPercentage}%

              //- Card body
              .card-body.d-flex.flex-column
                h5.card-title.product-title= product.title
                if product.description
                  p.card-text.product-description.text-muted= product.description

                .mt-auto
                  //- Price section
                  .product-price-section.mb-2
                    if product.discountPercentage && product.discountPercentage > 0
                      - var discountedPrice = product.price * (1 - product.discountPercentage / 100)
                      span.product-price-current= Math.round(discountedPrice).toLocaleString() + ' ₫'
                      span.product-price-original.ml-2= product.price.toLocaleString() + ' ₫'
                    else
                      span.product-price-current= product.price ? product.price.toLocaleString() + ' ₫' : 'Liên hệ'

                  //- Stock info
                  .product-stock
                    if product.stock > 10
                      span.text-success
                        i.fas.fa-check.mr-1
                        | Còn #{product.stock} sản phẩm
                    else if product.stock > 0
                      span.text-warning
                        i.fas.fa-exclamation-triangle.mr-1
                        | Chỉ còn #{product.stock} sản phẩm
                    else
                      span.text-danger
                        i.fas.fa-times-circle.mr-1
                        | Hết hàng

              //- Card footer with action buttons
              .card-footer.bg-white.border-top-0
                .btn-group.w-100(role="group")
                  a.btn.btn-outline-primary.btn-sm(href=`/products/detail/${product._id}`)
                    i.fas.fa-eye.mr-1
                    | Xem


    else
      //- Empty state
      .text-center.py-5
        .empty-state
          i.fas.fa-box-open.fa-4x.text-muted.mb-3
          h4.text-muted Chưa có sản phẩm nào
          p.text-muted Hiện tại chưa có sản phẩm nào để hiển thị.

